WITH 
RECURSIVE ECOLI_DATA_REC AS (
    SELECT 1 AS GEN, ID
      FROM ECOLI_DATA
     WHERE PARENT_ID IS NULL
    UNION ALL
    SELECT GEN + 1 AS GEN, T1.ID
      FROM ECOLI_DATA T1 , ECOLI_DATA_REC T2
     WHERE T1.PARENT_ID = T2.ID
       AND EXISTS (
        SELECT 1
          FROM ECOLI_DATA
         WHERE ECOLI_DATA.PARENT_ID = T2.ID
       )
)
SELECT COUNT(*) AS COUNT, GEN AS GENERATION 
  FROM ECOLI_DATA_REC
 WHERE ID NOT IN (
    SELECT PARENT_ID
      FROM ECOLI_DATA
     WHERE PARENT_ID IS NOT NULL
 )
 GROUP BY GEN
 ORDER BY GEN;